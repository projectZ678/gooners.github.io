<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>gooners.wtf | Sign Up</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/particles.css">
</head>
<body>

<!-- CLICK TO ENTER -->
<div id="enterScreen">
    <div id="enterText">CLICK TO ENTER</div>
</div>

<!-- BACKGROUND -->
<canvas id="particlesCanvas"></canvas>

<!-- FORM CONTAINER -->
<div class="main-container" id="mainContent">
    <div class="form-container">
        <div class="form-card">
            <div class="form-header">
                <h1 class="form-title">CREATE PROFILE</h1>
                <p class="form-subtitle">Claim your unique link</p>
            </div>

            <form id="signupForm">
                <div class="form-group">
                    <label for="username" class="form-label">USERNAME</label>
                    <input type="text" id="username" class="form-input" placeholder="choose username" required>
                    <div class="form-error" id="usernameError"></div>
                </div>

                <div class="form-group">
                    <label for="email" class="form-label">EMAIL</label>
                    <input type="email" id="email" class="form-input" placeholder="email@example.com" required>
                    <div class="form-error" id="emailError"></div>
                </div>

                <div class="form-group">
                    <label for="password" class="form-label">PASSWORD</label>
                    <input type="password" id="password" class="form-input" placeholder="••••••••" required>
                    <div class="form-error" id="passwordError"></div>
                </div>

                <div class="form-group">
                    <label for="confirmPassword" class="form-label">CONFIRM PASSWORD</label>
                    <input type="password" id="confirmPassword" class="form-input" placeholder="••••••••" required>
                    <div class="form-error" id="confirmPasswordError"></div>
                </div>

                <button type="submit" class="form-btn" id="submitBtn">CREATE ACCOUNT</button>
                <div class="form-message" id="successMessage"></div>
            </form>

            <div class="form-links">
                <a href="login.html" class="form-link">Already have an account?</a>
                <a href="index.html" class="form-link">Back to home</a>
            </div>
        </div>
    </div>
</div>

<script src="js/particles.js"></script>
<script src="js/main.js"></script>
<script>
// Initialize
initParticles();
initPage();

// Form submission
document.getElementById('signupForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Clear errors
    document.querySelectorAll('.form-error').forEach(el => {
        el.style.display = 'none';
        el.textContent = '';
    });
    
    const username = document.getElementById('username').value.trim();
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    
    let isValid = true;
    
    // Validate username
    const usernameValidation = validateUsername(username);
    if (!usernameValidation.valid) {
        showError('usernameError', usernameValidation.error);
        isValid = false;
    }
    
    // Validate email
    const emailValidation = validateEmail(email);
    if (!emailValidation.valid) {
        showError('emailError', emailValidation.error);
        isValid = false;
    }
    
    // Validate password
    const passwordValidation = validatePassword(password);
    if (!passwordValidation.valid) {
        showError('passwordError', passwordValidation.error);
        isValid = false;
    }
    
    // Confirm password
    if (password !== confirmPassword) {
        showError('confirmPasswordError', 'Passwords do not match');
        isValid = false;
    }
    
    if (isValid) {
        await createAccount(username, email, password);
    }
});

function showError(elementId, message) {
    const element = document.getElementById(elementId);
    element.textContent = message;
    element.style.display = 'block';
}

async function createAccount(username, email, password) {
    const button = document.getElementById('submitBtn');
    const originalText = button.textContent;
    button.textContent = 'CREATING...';
    button.disabled = true;
    
    try {
        // Simulate API call
        await new Promise(resolve => setTimeout(resolve, 1500));
        
        // Create user object
        const user = {
            id: Date.now().toString(),
            username: username,
            email: email,
            profileLink: username.toLowerCase(),
            createdAt: new Date().toISOString(),
            customizations: {
                pfp: CONFIG.DEFAULT_PFP,
                banner: CONFIG.DEFAULT_BANNER,
                music: '',
                bio: '',
                theme: 'dark'
            },
            stats: {
                visitors: 0,
                views: 0,
                lastActive: new Date().toISOString()
            }
        };
        
        // Save user
        saveUser(user);
        
        // Show success
        const successMessage = document.getElementById('successMessage');
        successMessage.textContent = `Profile created! Your link: ${CONFIG.SITE_URL}/${user.profileLink}`;
        successMessage.className = 'form-message form-success';
        successMessage.style.display = 'block';
        
        // Show notification
        showNotification('Account created successfully!');
        
        // Redirect to dashboard after 2 seconds
        setTimeout(() => {
            window.location.href = 'dashboard.html';
        }, 2000);
        
    } catch (error) {
        showError('usernameError', 'Error creating account. Please try again.');
        button.textContent = originalText;
        button.disabled = false;
    }
}
</script>
</body>
</html>