<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gooning Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <style>
    :root{
      --bg:#000;--glass:#111111ee;--glass-border:rgba(255,255,255,.1);
      --text:#fff;--muted:#aaa;--accent:#fff;--glow:#fff;
      font-family:'Inter',system-ui,sans-serif;
    }
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;outline:none;user-select:none;}
    html,body{min-height:100vh;background:var(--bg);overflow:hidden;color:var(--text);}
    .stars{position:fixed;inset:0;pointer-events:none;z-index:0;}
    .star{position:absolute;background:#fff;border-radius:50%;opacity:0;animation:fall linear infinite;}
    @keyframes fall{0%{transform:translateY(-100px) scale(.2);opacity:0;}10%{opacity:1;}90%{opacity:.3;}100%{transform:translateY(100vh) scale(.8);opacity:0;}}
    #app{display:flex;height:100vh;position:relative;z-index:1;}

    /* SIDEBAR */
    #sidebar{width:280px;background:var(--glass);border-right:1px solid var(--glass-border);
      backdrop-filter:blur(20px);padding:40px 24px;display:flex;flex-direction:column;align-items:center;
      box-shadow:0 0 60px rgba(255,255,255,.12);flex-shrink:0;}
    #pfp{width:130px;height:130px;border-radius:50%;overflow:hidden;margin-bottom:24px;
      border:3px solid var(--glow);box-shadow:0 0 40px var(--glow),0 0 80px rgba(255,255,255,.3);
      animation:pulsePfp 3s infinite alternate;}
    @keyframes pulsePfp{0%{box-shadow:0 0 40px var(--glow),0 0 80px rgba(255,255,255,.3);}
      100%{box-shadow:0 0 60px var(--glow),0 0 120px rgba(255,255,255,.4);}}
    #pfp img{width:100%;height:100%;object-fit:cover;}
    .sidebar-title{font-size:1.8rem;font-weight:800;letter-spacing:4px;color:var(--accent);
      margin-bottom:32px;text-shadow:0 0 20px rgba(255,255,255,.6);}
    .nav-btn{display:flex;align-items:center;gap:14px;width:100%;padding:14px 18px;
      background:rgba(255,255,255,.08);border:1px solid var(--glass-border);border-radius:14px;
      font-weight:600;cursor:pointer;transition:.3s;color:var(--text);margin-bottom:10px;
      backdrop-filter:blur(8px);}
    .nav-btn:hover{background:rgba(255,255,255,.16);transform:translateX(6px);
      box-shadow:0 0 30px rgba(255,255,255,.25);}
    .nav-btn.active{background:rgba(255,255,255,.22);border-color:var(--glow);color:var(--glow);
      box-shadow:0 0 40px rgba(255,255,255,.35);}
    .socials{margin-top:auto;display:flex;gap:16px;}
    .social-icon{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;
      justify-content:center;font-size:1.5rem;transition:.4s;cursor:pointer;position:relative;
      background:rgba(255,255,255,.1);border:1px solid var(--glass-border);color:var(--accent);}
    .social-icon:hover{transform:scale(1.2);box-shadow:0 0 30px rgba(255,255,255,.4);}

    /* MAIN */
    #main{flex:1;display:flex;flex-direction:column;padding:40px;background:rgba(0,0,0,.4);
      backdrop-filter:blur(12px);}
    h1{font-weight:800;font-size:3rem;letter-spacing:5px;color:var(--accent);
      text-shadow:0 0 50px rgba(255,255,255,.6);margin-bottom:28px;text-align:center;
      animation:titleGlow 3s ease-in-out infinite alternate;}
    @keyframes titleGlow{0%{text-shadow:0 0 40px rgba(255,255,255,.6);}
      100%{text-shadow:0 0 80px rgba(255,255,255,.8),0 0 140px rgba(255,255,255,.5);}}
    .panel{display:none;flex-direction:column;}
    .panel.active{display:flex;}

    /* GOON CLICKER */
    .clicker-panel{display:flex;flex-direction:column;align-items:center;gap:20px;}
    #goon-container{display:flex;align-items:center;gap:20px;margin:20px 0;}
    #goon-dude-container{width:320px;height:380px;position:relative;cursor:pointer;}
    #goon-dude{width:100%;height:100%;filter:drop-shadow(0 0 40px #fff);transition:.2s;}
    #goon-dude:active{transform:scale(0.92);}

    /* IDLE & CLICK STROKE */
    .stroking-arm{transform-origin:60% 40%;animation:idleStroke 2s ease-in-out infinite;}
    @keyframes idleStroke{
      0%,100%{transform:rotate(0deg);}
      50%{transform:rotate(-20deg);}
    }
    .stroking-arm.click{animation:strongStroke 0.4s ease-out;}

    /* BADGES */
    .badges{display:flex;gap:12px;flex-wrap:wrap;}
    .badge{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;
      font-weight:900;font-size:0.9rem;color:#000;opacity:0;transition:opacity 0.6s,transform 0.6s;transform:scale(0);}
    .badge.unlocked{opacity:1;transform:scale(1);}
    .badge.bronze{background:#cd7f32;}
    .badge.gold{background:#ffd700;}
    .badge.hof{background:linear-gradient(45deg,#ff0,#f0f,#0ff);box-shadow:0 0 30px #fff;}

    #points{font-size:3.5rem;font-weight:800;color:#fff;text-shadow:0 0 30px #fff;}
    #gps{font-size:1.5rem;color:#aaa;margin-top:10px;}
    #current-goons{font-size:1.2rem;color:#ccc;margin-top:8px;}

    /* GOONSTEGIE BAR */
    .goonstegie-container{width:100%;max-width:900px;margin:20px 0;display:flex;flex-direction:column;gap:8px;}
    .goonstegie-bar{height:28px;background:rgba(255,255,255,.1);border:1px solid var(--glass-border);border-radius:14px;overflow:hidden;position:relative;}
    .goonstegie-fill{height:100%;background:linear-gradient(90deg,#0f0,#0f8);width:0%;transition:width 0.4s ease;}
    .goonstegie-text{position:absolute;top:0;left:0;right:0;text-align:center;line-height:28px;font-weight:700;color:#fff;text-shadow:0 0 10px #000;font-size:1rem;}

    .upgrades-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;width:100%;max-width:1200px;margin:30px 0;}
    .upgrade{background:rgba(255,255,255,.08);border:1px solid var(--glass-border);border-radius:16px;
      padding:20px;text-align:center;transition:.3s;cursor:pointer;position:relative;overflow:hidden;}
    .upgrade:hover{background:rgba(255,255,255,.15);transform:translateY(-6px);box-shadow:0 0 40px #fff;}
    .upgrade.bought{opacity:0.6;pointer-events:none;}
    .upgrade-name{font-weight:700;color:#fff;font-size:1.2rem;}
    .upgrade-cost{font-size:1rem;color:#ccc;margin-top:8px;}
    .upgrade-effect{font-size:0.9rem;color:#888;margin-top:10px;}
    .upgrade-level{position:absolute;top:10px;right:10px;background:#fff;color:#000;padding:4px 10px;
      border-radius:10px;font-size:0.75rem;font-weight:800;}

    .prestige-btn{margin:20px 0;padding:18px 50px;background:#fff;color:#000;border:none;
      border-radius:18px;font-weight:800;cursor:pointer;transition:.4s;box-shadow:0 0 50px #fff;font-size:1.3rem;}
    .prestige-btn:hover{transform:scale(1.12);box-shadow:0 0 100px #fff;}
    .prestige-btn:disabled{opacity:0.5;cursor:not-allowed;}

    /* SPLAT */
    .splat{position:fixed;pointer-events:none;z-index:9999;opacity:0;
      width:80px;height:80px;background:#fff;border-radius:50%;filter:blur(8px);
      animation:splatAnim 0.8s ease-out forwards;}
    @keyframes splatAnim{
      0%{transform:scale(0);opacity:1;}
      70%{transform:scale(1.8);opacity:0.8;}
      100%{transform:scale(2.2);opacity:0;}
    }
    .giant-splat{position:fixed;inset:0;background:#fff;z-index:10000;opacity:0;
      animation:giantSplat 1.4s ease-out forwards;}
    @keyframes giantSplat{
      0%{transform:scale(0);opacity:1;}
      60%{transform:scale(1.3);opacity:0.9;}
      100%{transform:scale(1.5);opacity:0;}
    }

    /* LOADER */
    #loader{position:fixed;inset:0;background:var(--bg);display:flex;flex-direction:column;
      align-items:center;justify-content:center;z-index:100;cursor:pointer;transition:opacity 1s ease;}
    #logo{font-size:6rem;font-weight:900;color:var(--accent);text-shadow:0 0 30px #fff;
      animation:glow 2.5s infinite alternate;}
    @keyframes glow{from{text-shadow:0 0 30px #fff;}to{text-shadow:0 0 80px #fff,0 0 160px #fff;}}
    .hidden{display:none!important;}

    @keyframes shake{0%,100%{transform:translateX(0);}25%{transform:translateX(-12px);}75%{transform:translateX(12px);}}
    @keyframes strongStroke{
      0%{transform:rotate(0deg);}
      50%{transform:rotate(-70deg);}
      100%{transform:rotate(0deg);}
    }
  </style>
</head>
<body>
  <div class="stars" id="stars"></div>

  <!-- LOADER -->
  <div id="loader" tabindex="0" role="button" aria-label="Enter Hub">
    <div id="logo">GOONING</div>
    <div style="margin-top:22px;color:#aaa;font-size:1.3rem;">Click or press Enter</div>
  </div>

  <div id="app" class="hidden">
    <!-- SIDEBAR -->
    <div id="sidebar">
      <div id="pfp">
        <img src="https://i.pinimg.com/1200x/65/ce/74/65ce749c9a83c75ee8f49bd698097a09.jpg" alt="PFP">
      </div>
      <div class="sidebar-title">GOONING</div>
      <div class="nav-btn active" data-panel="clicker">GOON CLICKER</div>
      <div class="nav-btn" data-panel="home">Leaderboard</div>
      <div class="nav-btn" data-panel="promo">Vault 13</div>
      <div class="nav-btn" data-panel="credits">Credits</div>
      <div class="socials">
        <a href="https://github.com/projectZ678" target="_blank" class="social-icon">GitHub</a>
      </div>
    </div>

    <!-- MAIN -->
    <div id="main">
      <!-- GOON CLICKER -->
      <div id="clicker" class="panel active">
        <h1>GOON CLICKER</h1>
        <div class="clicker-panel">
          <div id="points">0</div>
          <div id="gps">0 GPS</div>
          <div id="current-goons">Current Goons: 0</div>

          <!-- GOON + BADGES -->
          <div id="goon-container">
            <div id="goon-dude-container" onclick="clickGoon(event)">
              <svg id="goon-dude" viewBox="0 0 300 380" xmlns="http://www.w3.org/2000/svg">
                <!-- Body -->
                <ellipse cx="150" cy="220" rx="70" ry="100" fill="#ffdbac"/>
                <!-- Head -->
                <circle cx="150" cy="100" r="60" fill="#ffdbac"/>
                <!-- Eyes -->
                <circle cx="130" cy="90" r="12" fill="#000"/>
                <circle cx="170" cy="90" r="12" fill="#000"/>
                <!-- Mouth -->
                <path d="M120 115 Q150 130 180 115" stroke="#000" stroke-width="4" fill="none"/>
                <!-- Hair -->
                <path d="M90 70 Q150 50 210 70" fill="#8B4513"/>
                <!-- Arm (stroking) -->
                <g class="stroking-arm">
                  <rect x="180" y="180" width="40" height="100" rx="20" fill="#ffdbac"/>
                  <circle cx="200" cy="280" r="25" fill="#ffdbac"/>
                </g>
                <!-- Leg -->
                <rect x="110" y="300" width="40" height="80" rx="20" fill="#ffdbac"/>
                <rect x="150" y="300" width="40" height="80" rx="20" fill="#ffdbac"/>
              </svg>
            </div>
            <div class="badges" id="badges"></div>
          </div>

          <!-- GOONSTEGIE BAR -->
          <div class="goonstegie-container">
            <div class="goonstegie-bar">
              <div class="goonstegie-fill" id="goonstegie-fill"></div>
              <div class="goonstegie-text" id="goonstegie-text">Need 100K for Prestige</div>
            </div>
          </div>

          <div class="upgrades-grid" id="upgrades"></div>
          <button class="prestige-btn" id="prestige">PRESTIGE (x2 → x54 Max)</button>
        </div>
      </div>

      <!-- OTHER PANELS (unchanged) -->
      <div id="home" class="panel">...</div>
      <div id="promo" class="panel">...</div>
      <div id="credits" class="panel">...</div>
    </div>
  </div>

  <script>
    const $ = id => document.getElementById(id);
    const stars = $('#stars');
    let starCnt = 0;

    function addStar(){
      if(starCnt>120) return;
      const s=document.createElement('div'); s.className='star';
      const sz = Math.random()*2.5+0.8;
      s.style.width=s.style.height=`${sz}px`;
      s.style.left=`${Math.random()*100}vw`;
      s.style.animationDuration=`${Math.random()*6+4}s`;
      s.style.animationDelay=`${Math.random()*3}s`;
      stars.appendChild(s); starCnt++;
      setTimeout(()=>{s.remove();starCnt--;},10000);
    }
    setInterval(addStar,250);

    // === LOADER ===
    function enterHub(){
      const loader = $('loader');
      loader.style.opacity = '0';
      setTimeout(() => {
        loader.classList.add('hidden');
        $('app').classList.remove('hidden');
        initClicker();
        fetchLeaderboard();
        setInterval(fetchLeaderboard, 60000);
      }, 800);
    }

    const loader = $('loader');
    loader.addEventListener('click', enterHub);
    loader.addEventListener('keydown', e => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        enterHub();
      }
    });
    loader.focus();

    // Panel switching
    document.querySelectorAll('.nav-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        btn.classList.add('active');
        $(btn.dataset.panel).classList.add('active');
      });
    });

    // === GOON CLICKER ===
    let points = 0, gps = 0, clickPower = 1, prestige = 1, totalGoons = 0;
    let currentGoons = 0;
    const arm = document.querySelector('.stroking-arm');

    const badges = [
      {name:"Bronze",req:2000,color:"#cd7f32",icon:"B"},
      {name:"Gold",req:100000,color:"#ffd700",icon:"G"},
      {name:"Hall of Fame",req:1000000,color:"linear-gradient(45deg,#ff0,#f0f,#0ff)",icon:"HOF"}
    ];

    const upgrades = [
      {id:'auto',name:'Auto-Gooner',baseCost:50,cost:50,effect:35,owned:0,type:'gps',max:200},
      {id:'double',name:'Double Click',baseCost:200,cost:200,effect:10,owned:0,type:'click',max:150},
      {id:'neon',name:'Neon Boost',baseCost:1000,cost:1000,effect:100,owned:0,type:'gps',max:100},
      {id:'vault',name:'Vault Pass',baseCost:5000,cost:5000,effect:0.5,owned:0,type:'prestige',max:10},
      {id:'mega',name:'Mega Click',baseCost:25000,cost:25000,effect:500,owned:0,type:'click',max:80},
      {id:'hyper',name:'Hyper GPS',baseCost:100000,cost:100000,effect:1000,owned:0,type:'gps',max:60},
      {id:'god',name:'God Mode',baseCost:500000,cost:500000,effect:0.2,owned:0,type:'multi',max:25},
      {id:'quantum',name:'Quantum Edge',baseCost:1e6,cost:1e6,effect:0.5,owned:0,type:'clickMulti',max:30},
      {id:'void',name:'Void Engine',baseCost:5e6,cost:5e6,effect:5000,owned:0,type:'gps',max:40},
      {id:'pulse',name:'Goon Pulse',baseCost:2e7,cost:2e7,effect:2,owned:0,type:'gpsMulti',max:20},
      {id:'dark',name:'Dark Matter',baseCost:1e8,cost:1e8,effect:10000,owned:0,type:'click',max:25},
      {id:'singularity',name:'Singularity',baseCost:5e8,cost:5e8,effect:10,owned:0,type:'multi',max:15},
      {id:'infinity',name:'Infinity Loop',baseCost:2e9,cost:2e9,effect:100000,owned:0,type:'gps',max:15},
      {id:'rift',name:'Cosmic Rift',baseCost:1e10,cost:1e10,effect:1e6,owned:0,type:'click',max:10},
      {id:'eternal',name:'Eternal Flame',baseCost:1e12,cost:1e12,effect:0.5,owned:0,type:'multi',max:20},
      {id:'nebula',name:'Nebula Core',baseCost:1e14,cost:1e14,effect:5e6,owned:0,type:'gps',max:8},
      {id:'titan',name:'Titan Click',baseCost:3e14,cost:3e14,effect:300000,owned:0,type:'click',max:5},
      {id:'paradise',name:"UZI'S GOON PARADISE",baseCost:2e18,cost:2e18,effect:5e7,owned:0,type:'paradise',max:1}
    ];

    function initClicker(){
      loadGame();
      renderUpgrades();
      renderBadges();
      updateDisplay();
      setInterval(autoEarn, 100);
      setInterval(saveGame, 5000);
      setInterval(updateGoonstegieBar, 100);
    }

    function gainGoons(amount) {
      const earned = amount * prestige;
      points += earned;
      currentGoons += earned;
      totalGoons += earned;
      updateDisplay();
      checkBadges();
    }

    function clickGoon(e) {
      gainGoons(clickPower);
      createSplat(e.clientX, e.clientY);
      screenShake();
      arm.classList.add('click');
      setTimeout(() => arm.classList.remove('click'), 400);
    }

    function createSplat(x, y) {
      const splat = document.createElement('div');
      splat.className = 'splat';
      splat.style.left = `${x - 40}px`;
      splat.style.top = `${y - 40}px`;
      document.body.appendChild(splat);
      setTimeout(() => splat.remove(), 800);
    }

    function prestigeSplat() {
      const giant = document.createElement('div');
      giant.className = 'giant-splat';
      document.body.appendChild(giant);
      setTimeout(() => giant.remove(), 1400);
    }

    function autoEarn(){
      if (gps > 0) gainGoons(gps / 10);
    }

    function buyUpgrade(id){
      const u = upgrades.find(x => x.id === id);
      if (!u || points < u.cost || u.owned >= u.max) return;

      points -= u.cost;
      currentGoons -= u.cost;
      u.owned++;
      u.cost = u.id === 'paradise' ? u.baseCost : Math.floor(u.baseCost * Math.pow(1.6, u.owned));

      if (u.type === 'gps') gps += u.effect;
      if (u.type === 'click') clickPower += u.effect;
      if (u.type === 'prestige') prestige = Math.min(54, prestige + u.effect);
      if (u.type === 'multi') { clickPower *= (1 + u.effect); gps *= (1 + u.effect); }
      if (u.type === 'clickMulti') clickPower *= (1 + u.effect);
      if (u.type === 'gpsMulti') gps *= (1 + u.effect);
      if (u.type === 'paradise') {
        gps += 5e7;
        prestige = 54;
        showAchievement("UZI'S GOON PARADISE UNLOCKED! x54 PRESTIGE!");
      }

      renderUpgrades();
      updateDisplay();
    }

    function prestigeReset(){
      if (currentGoons < 100000) return showAchievement("Need 100K Current Goons!");
      prestigeSplat();
      prestige = Math.min(54, prestige + 1);
      points = 0; gps = 0; clickPower = 1; currentGoons = 0;
      totalGoons = Math.floor(totalGoons * 0.1);
      upgrades.forEach(u => { if (u.id !== 'paradise') { u.owned = 0; u.cost = u.baseCost; } });
      renderUpgrades();
      updateDisplay();
      showAchievement(`PRESTIGED! x${prestige} Multiplier`);
    }

    function updateGoonstegieBar(){
      const target = 100000;
      const progress = Math.min(currentGoons / target, 1);
      $('goonstegie-fill').style.width = `${progress * 100}%`;
      $('goonstegie-text').textContent = currentGoons >= target ? "PRESTIGE READY!" : `Need ${formatNumber(target - currentGoons)} more`;
      $('prestige').disabled = currentGoons < target;
    }

    function formatNumber(n) {
      if (n >= 1e18) return (n/1e18).toFixed(2) + 'Q';
      if (n >= 1e15) return (n/1e15).toFixed(2) + 'P';
      if (n >= 1e12) return (n/1e12).toFixed(2) + 'T';
      if (n >= 1e9) return (n/1e9).toFixed(2) + 'B';
      if (n >= 1e6) return (n/1e6).toFixed(2) + 'M';
      if (n >= 1e3) return (n/1e3).toFixed(1) + 'K';
      return Math.floor(n).toLocaleString();
    }

    function renderUpgrades(){
      $('upgrades').innerHTML = upgrades.map(u => `
        <div class="upgrade ${u.owned >= u.max ? 'bought' : ''}" onclick="buyUpgrade('${u.id}')" style="${u.id==='paradise'?'border:4px solid gold;':''}">
          <div class="upgrade-name" style="${u.id==='paradise'?'color:gold;font-weight:900;':''}">${u.name}</div>
          <div class="upgrade-cost">Cost: ${formatNumber(u.cost)}</div>
          <div class="upgrade-effect">
            ${u.type === 'gps' ? `+${formatNumber(u.effect)} GPS` :
             u.type === 'click' ? `+${formatNumber(u.effect)} Click` :
             u.type === 'prestige' ? `+${u.effect} Prestige` :
             u.type === 'multi' ? `+${(u.effect*100).toFixed(0)}% All` :
             u.type === 'clickMulti' ? `+${(u.effect*100).toFixed(0)}% Click` :
             u.type === 'gpsMulti' ? `+${(u.effect*100).toFixed(0)}% GPS` :
             u.type === 'paradise' ? `+50M GPS | x54 Prestige` : ''}
          </div>
          <div class="upgrade-level">Lv.${u.owned}/${u.max}</div>
        </div>
      `).join('');
    }

    function renderBadges(){
      $('badges').innerHTML = badges.map(b => `
        <div class="badge ${b.unlocked?'unlocked':''} ${b.name.toLowerCase()}" style="background:${b.color};">
          ${b.icon}
        </div>
      `).join('');
    }

    function checkBadges(){
      badges.forEach(b => {
        if (totalGoons >= b.req && !b.unlocked) {
          b.unlocked = true;
          renderBadges();
          showAchievement(`${b.name} GOON BADGE UNLOCKED!`);
        }
      });
    }

    function updateDisplay(){
      $('points').textContent = formatNumber(Math.floor(points));
      $('gps').textContent = `${formatNumber(gps)} GPS`;
      $('current-goons').textContent = `Current Goons: ${formatNumber(Math.floor(currentGoons))}`;
      $('prestige').textContent = `PRESTIGE (x${prestige} → x54 Max)`;
    }

    function screenShake(){
      document.body.style.animation = 'shake 0.5s';
      setTimeout(() => document.body.style.animation = '', 500);
    }

    function showAchievement(text){
      const a = document.createElement('div');
      a.className = 'achievement';
      a.textContent = text;
      document.body.appendChild(a);
      setTimeout(() => a.style.opacity = 1, 100);
      setTimeout(() => { a.style.opacity = 0; setTimeout(() => a.remove(), 500); }, 5000);
    }

    function saveGame(){
      const save = { points, gps, clickPower, prestige, totalGoons, currentGoons, upgrades: upgrades.map(u => ({id:u.id,owned:u.owned,cost:u.cost})), badges: badges.map(b=>({name:b.name,unlocked:b.unlocked})) };
      localStorage.setItem('goonSave', JSON.stringify(save));
    }

    function loadGame(){
      const save = JSON.parse(localStorage.getItem('goonSave') || '{}');
      if (save) {
        points = save.points || 0;
        gps = save.gps || 0;
        clickPower = save.clickPower || 1;
        prestige = save.prestige || 1;
        totalGoons = save.totalGoons || 0;
        currentGoons = save.currentGoons || 0;
        save.upgrades?.forEach(su => {
          const u = upgrades.find(x => x.id === su.id);
          if (u) { u.owned = su.owned; u.cost = su.cost; }
        });
        save.badges?.forEach(sb => {
          const b = badges.find(x => x.name === sb.name);
          if (b) b.unlocked = sb.unlocked;
        });
      }
    }

    $('prestige').onclick = prestigeReset;

    // === LEADERBOARD (unchanged) ===
    async function fetchLeaderboard(){ /* ... */ }
    function e(t){ /* ... */ }
    const board = $('board');
    const zoomPercent = $('#zoomPercent');
    let scale = 0.5;
    function updateZoom(){ /* ... */ }
    $('#zoomIn').onclick = () => { scale = Math.min(scale + 0.1, 2); updateZoom(); };
    $('#zoomOut').onclick = () => { scale = Math.max(scale - 0.1, 0.3); updateZoom(); };
    $('#zoomReset').onclick = () => { scale = 0.5; updateZoom(); };
    updateZoom();
  </script>
</body>
</html>
