<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Gooning Leaderboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root{
  --bg:#0a0a0a;--panel:#111;--text:#eee;--muted:#888;--glow:rgba(255,255,255,.2);
  --accent:#fff;--discord:#5865F2;--transition:300ms ease;
  font-family:"Inter",system-ui,sans-serif;
}
*{box-sizing:border-box}
body{
  margin:0;min-height:100vh;
  background:
    radial-gradient(circle at 30% 20%,rgba(255,255,255,.04),transparent 30%),
    radial-gradient(circle at 80% 80%,rgba(255,255,255,.03),transparent 40%),
    var(--bg);
  color:var(--text);display:flex;align-items:center;justify-content:center;
}
#app{width:100%;max-width:800px;padding:24px}
h1{
  text-align:center;font-weight:800;font-size:2rem;letter-spacing:1px;
  color:var(--accent);text-shadow:0 0 20px var(--glow);
}
table{
  width:100%;border-collapse:collapse;margin-top:24px;border-radius:12px;
  overflow:hidden;box-shadow:0 0 40px rgba(0,0,0,.6),0 0 20px rgba(255,255,255,.02) inset;
}
thead{
  background:rgba(255,255,255,.05);text-transform:uppercase;
  font-size:.8rem;letter-spacing:1px;color:var(--muted);
}
th,td{padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.05);text-align:left}
tr:hover{
  background:rgba(255,255,255,.03);transform:translateY(-2px);
  box-shadow:0 6px 16px rgba(255,255,255,.03);
  transition:transform var(--transition),box-shadow var(--transition);
}
.rank{font-weight:700;color:var(--accent)}
.name{display:flex;align-items:center;gap:12px}
.avatar{width:40px;height:40px;border-radius:10px;overflow:hidden;box-shadow:0 0 10px rgba(255,255,255,.05)}
.avatar img{width:100%;height:100%;display:block}
.discord-tag{display:flex;align-items:center;gap:6px;font-size:.85rem;color:var(--discord);font-weight:500}
.discord-tag i{font-size:1rem}
.score{text-align:right;font-weight:600}
#loader{
  position:fixed;inset:0;background:var(--bg);display:flex;flex-direction:column;
  align-items:center;justify-content:center;transition:opacity 700ms ease;z-index:10;
}
#logo{
  font-size:2.5rem;font-weight:900;text-transform:uppercase;color:var(--accent);
  letter-spacing:2px;animation:glow 2s infinite alternate;cursor:pointer;
}
@keyframes glow{
  from{text-shadow:0 0 5px var(--accent);opacity:.7}
  to{text-shadow:0 0 25px var(--accent),0 0 50px var(--accent);opacity:1}
}
.hidden{opacity:0;pointer-events:none}
footer{margin-top:30px;text-align:center;font-size:.8rem;color:var(--muted)}
.last-updated{font-size:.75rem;color:var(--muted);text-align:center;margin-top:10px}
</style>
</head>
<body>
<div id="loader">
  <div id="logo">GOONING</div>
  <div style="margin-top:12px;color:#777;">Click to enter</div>
</div>

<div id="app" style="display:none;">
  <h1>Leaderboard</h1>
  <table id="board">
    <thead><tr><th>Rank</th><th>Player</th><th class="score">Score</th></tr></thead>
    <tbody id="rows"></tbody>
  </table>
  <div class="last-updated" id="updated"></div>
  <footer>Auto-updated from Discord • <a href="leaderboard.json" target="_blank" style="color:var(--muted)">view raw JSON</a></footer>
</div>

<script>
const JSON_FILE = "leaderboard.json";

async function fetchLeaderboard(){
  try{
    const res = await fetch(JSON_FILE + "?t=" + Date.now());
    const data = await res.json();
    const list = data.leaderboard || [];
    const updated = data.updated || "never";
    render(list);
    document.getElementById("updated").textContent = `Last updated: ${updated}`;
  }catch(e){
    console.error(e);
    document.getElementById("rows").innerHTML = `<tr><td colspan="3">Error loading data</td></tr>`;
  }
}
function render(list){
  const rows = list.map(p=>`
    <tr>
      <td class="rank">#${p.rank}</td>
      <td class="name">
        <div class="avatar"><img src="${p.avatar||'https://cdn.discordapp.com/embed/avatars/0.png'}" alt=""></div>
        <div>
          <div>${p.name}</div>
          ${p.discord?`<div class="discord-tag"><i class="fab fa-discord"></i>${p.discord}</div>`:''}
        </div>
      </td>
      <td class="score">${p.score.toLocaleString()}</td>
    </tr>`).join("");
  document.getElementById("rows").innerHTML = rows;
}

/* Loader → App */
const loader = document.getElementById("loader");
document.getElementById("logo").addEventListener("click",()=>{
  loader.classList.add("hidden");
  setTimeout(()=>{
    loader.style.display="none";
    document.getElementById("app").style.display="block";
    fetchLeaderboard();
    setInterval(fetchLeaderboard,5*60*1000);   // refresh every 5 min
  },700);
});
</script>
</body>
</html>
