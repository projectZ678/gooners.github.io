<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Gooning Leaderboard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#050505;--glass:#111111ee;--glass-border:rgba(255,255,255,.08);
      --text:#f5f5f5;--muted:#aaaaaa;--accent:#fff;--discord:#ccc;
      --transition:.35s cubic-bezier(.25,.8,.25,1);
      --scrollbar:#444;--scrollbar-hover:#666;
      --goon:#ff4d8c;--stamina:#4dff88;--gold:#ffd700;
      font-family:'Inter',system-ui,sans-serif;
    }
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;outline:none;user-select:none}
    html,body{min-height:100vh;background:var(--bg);overflow:hidden;color:var(--text);
      display:flex;justify-content:center;align-items:center;padding:12px}
    .stars{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0}
    .star{position:absolute;background:#fff;border-radius:50%;opacity:0;animation:fall linear infinite}
    @keyframes fall{0%{transform:translateY(-100px) scale(.2);opacity:0}10%{opacity:1}90%{opacity:.3}100%{transform:translateY(100vh) scale(.8);opacity:0}}
    #app{
      max-width:1200px;width:100%;height:720px;position:relative;z-index:1;
      backdrop-filter:blur(22px);background:var(--glass);
      border:1px solid var(--glass-border);border-radius:26px;
      padding:40px 44px;
      box-shadow:0 18px 70px rgba(0,0,0,.85),inset 0 0 40px rgba(255,255,255,.06);
      transition:all .5s var(--transition);margin:auto;
      display:flex;flex-direction:column;overflow:hidden
    }
    #app:hover{transform:scale(1.03) translateY(-4px);box-shadow:0 28px 90px rgba(0,0,0,.92),0 0 50px rgba(255,255,255,.15)}
    h1{
      text-align:center;font-weight:800;font-size:2.8rem;letter-spacing:3px;
      background:linear-gradient(90deg,#fff,#ddd);background-clip:text;-webkit-background-clip:text;color:transparent;
      text-shadow:0 0 35px rgba(255,255,255,.35);margin-bottom:30px;
      animation:titleGlow 3s ease-in-out infinite alternate
    }
    @keyframes titleGlow{from{text-shadow:0 0 22px var(--accent)}to{text-shadow:0 0 45px var(--accent),0 0 90px var(--accent)}}
    .tabs{display:flex;justify-content:center;gap:20px;margin-bottom:30px}
    .tab{
      padding:14px 36px;background:rgba(255,255,255,.07);border:1px solid var(--glass-border);
      border-radius:16px;font-weight:600;font-size:1rem;cursor:pointer;transition:all .3s var(--transition);
      color:var(--muted);backdrop-filter:blur(5px)
    }
    .tab.active{
      background:rgba(255,255,255,.18);color:var(--accent);border-color:rgba(255,255,255,.25);
      box-shadow:0 0 25px rgba(255,255,255,.15);transform:translateY(-3px)
    }
    .tab:hover:not(.active){background:rgba(255,255,255,.12);transform:translateY(-3px)}
    .panel{display:none;animation:fadeIn .6s ease;overflow:hidden}
    .panel.active{display:flex;flex-direction:column;height:100%}
    @keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

    /* LEADERBOARD */
    .table-container{
      flex:1;overflow-y:auto;border-radius:18px;margin-top:20px;
      border:1px solid var(--glass-border);background:rgba(0,0,0,.25);
      box-shadow:inset 0 8px 16px rgba(0,0,0,.45);scrollbar-width:thin;scrollbar-color:var(--scrollbar) transparent
    }
    .table-container::-webkit-scrollbar{width:11px}
    .table-container::-webkit-scrollbar-track{background:transparent}
    .table-container::-webkit-scrollbar-thumb{
      background:var(--scrollbar);border-radius:6px;border:2px solid transparent;background-clip:content-box
    }
    .table-container::-webkit-scrollbar-thumb:hover{background:var(--scrollbar-hover)}
    table{width:100%;border-collapse:collapse}
    thead{
      position:sticky;top:0;z-index:10;
      background:linear-gradient(180deg,rgba(28,28,28,.98),rgba(18,18,18,.95));
      backdrop-filter:blur(14px);text-transform:uppercase;font-size:.85rem;letter-spacing:2px;
      color:var(--muted);border-bottom:1px solid var(--glass-border)
    }
    th,td{padding:22px 26px;transition:all .3s var(--transition)}
    tr:hover{background:rgba(255,255,255,.1);transform:translateX(8px);box-shadow:0 10px 22px rgba(255,255,255,.1)}
    .rank{font-weight:800;color:var(--accent);font-size:1.6rem;text-align:center;text-shadow:0 0 16px rgba(255,255,255,.45)}
    .rank:nth-of-type(1){color:#ffd700;font-size:1.8rem;text-shadow:0 0 28px #ffd700}
    .rank:nth-of-type(2){color:#c0c0c0;font-size:1.75rem;text-shadow:0 0 24px #c0c0c0}
    .rank:nth-of-type(3){color:#cd7f32;font-size:1.7rem;text-shadow:0 0 22px #cd7f32}
    .name{display:flex;align-items:center;gap:24px;font-size:1.08rem}
    .avatar{width:62px;height:62px;border-radius:16px;overflow:hidden;
      box-shadow:0 0 22px rgba(0,0,0,.55),0 0 0 1px rgba(255,255,255,.18);flex-shrink:0;transition:transform .3s ease}
    tr:hover .avatar{transform:scale(1.25) rotate(8deg)}
    .avatar img{width:100%;height:100%;object-fit:cover}
    .discord-tag{display:flex;align-items:center;gap:9px;font-size:.9rem;color:var(--discord);margin-top:5px}
    .discord-tag i{filter:drop-shadow(0 0 8px #5865f2);animation:discordPulse 2.5s infinite alternate}
    @keyframes discordPulse{from{filter:drop-shadow(0 0 8px #5865f2)}to{filter:drop-shadow(0 0 16px #5865f2)}}
    .empty-slot{color:#666;font-style:italic;font-size:1.04rem}

    /* GOON CLICKER - MAIN GAME */
    #goon-game{display:flex;flex-direction:column;height:100%;gap:20px}
    #goon-top{display:flex;gap:36px;align-items:start;flex:1;min-height:0}
    #goon-left{display:flex;flex-direction:column;align-items:center;flex:1}
    #next-prestige-bar{background:rgba(0,0,0,.55);padding:12px 24px;border-radius:14px;font-size:1rem;color:#fff;border:1px solid var(--glass-border);margin-bottom:18px;z-index:10;align-self:center;width:280px;text-align:center;box-shadow:0 0 20px rgba(255,77,140,.3)}
    #prestige-progress{width:100%;height:12px;background:#333;border-radius:6px;overflow:hidden;margin-top:8px}
    #prestige-fill{height:100%;background:var(--goon);width:0%;transition:width .35s ease;box-shadow:0 0 15px var(--goon)}
    #goon-big{
      width:260px;height:360px;cursor:pointer;position:relative;
      background:#111;border-radius:18px;overflow:hidden;
      box-shadow:0 0 60px var(--goon),0 0 120px rgba(255,77,140,.7);
      transition:transform .18s
    }
    #goon-big:active{transform:scale(.94)}
    #goon-big svg{width:100%;height:100%}
    #goon-big .arm{transform-origin:68% 38%;animation:stroke 1.2s ease-in-out infinite alternate}
    @keyframes stroke{0%{transform:rotate(-15deg)}100%{transform:rotate(25deg)}}
    #goon-big:active .arm{animation-duration:.2s}
    #goon-big .head{animation:goonFace 4s ease-in-out infinite}
    @keyframes goonFace{0%,100%{transform:translateY(0)}50%{transform:translateY(5px)}}
    #goon-stats{font-size:1.45rem;margin:20px 0;text-align:center;font-weight:600;color:var(--goon);width:100%;text-shadow:0 0 12px var(--goon)}
    #goon-stats span{color:var(--accent)}
    #goon-prestige{
      margin-top:14px;padding:16px 44px;background:var(--gold);color:#000;
      border:none;border-radius:14px;font-weight:600;cursor:pointer;font-size:1.2rem;transition:.3s;width:240px;box-shadow:0 0 20px var(--gold)
    }
    #goon-prestige:hover{background:#ffea80;transform:scale(1.06)}
    #goon-prestige.disabled{opacity:.5;cursor:not-allowed}
    #goon-multiplier{display:inline-block;margin-left:12px;color:var(--goon);font-weight:700}

    /* UPGRADES */
    #goon-upgrades-wrapper{flex:1;overflow-y:auto;padding:0 18px 18px 0;margin-right:-18px;scrollbar-width:thin;scrollbar-color:var(--scrollbar) transparent;display:flex;flex-direction:column;gap:12px}
    #goon-upgrades-wrapper::-webkit-scrollbar{width:10px}
    #goon-upgrades-wrapper::-webkit-scrollbar-track{background:transparent}
    #goon-upgrades-wrapper::-webkit-scrollbar-thumb{background:var(--scrollbar);border-radius:5px}
    #goon-upgrades-wrapper::-webkit-scrollbar-thumb:hover{background:var(--scrollbar-hover)}
    .goon-upgrade{
      background:rgba(255,255,255,.08);border:1px solid var(--glass-border);
      border-radius:14px;padding:16px;cursor:pointer;transition:.28s;
      display:flex;align-items:center;gap:16px;font-size:1.02rem;box-shadow:0 4px 14px rgba(0,0,0,.3)
    }
    .goon-upgrade:hover{background:rgba(255,255,255,.16);transform:translateY(-3px);box-shadow:0 8px 18px rgba(255,255,255,.12)}
    .goon-upgrade.disabled{opacity:.5;cursor:not-allowed}
    .goon-upgrade-icon{
      width:42px;height:42px;background:var(--goon);color:#000;border-radius:12px;
      display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1.15rem;box-shadow:0 0 15px var(--goon)
    }

    /* BOTTOM PANEL: COSMETICS + RANKED */
    #goon-bottom{display:grid;grid-template-columns:1fr 1fr;gap:28px;padding:24px;background:rgba(0,0,0,.3);border-radius:18px;border:1px solid var(--glass-border);box-shadow:inset 0 0 20px rgba(0,0,0,.4)}
    #cosmetic-shop, #ranked-mode{padding:0}
    #cosmetic-shop h3, #ranked-mode h3{font-size:1.5rem;margin-bottom:16px;color:var(--goon);text-shadow:0 0 14px var(--goon);text-align:center}
    #ranked-mode h3{color:var(--gold);text-shadow:0 0 14px var(--gold)}
    #cosmetics-list, #ranked-cosmetics-list{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .cosmetic-item, .ranked-cosmetic{
      background:rgba(255,255,255,.08);border:1px solid var(--glass-border);
      border-radius:14px;padding:14px;cursor:pointer;transition:.28s;
      display:flex;flex-direction:column;align-items:center;text-align:center;gap:8px;font-size:.95rem;box-shadow:0 4px 12px rgba(0,0,0,.3)
    }
    .cosmetic-item:hover, .ranked-cosmetic:hover{background:rgba(255,255,255,.16);transform:translateY(-4px);box-shadow:0 8px 20px rgba(255,255,255,.1)}
    .cosmetic-item.locked{opacity:.5;cursor:not-allowed}
    .cosmetic-item.unlocked, .ranked-cosmetic.unlocked{background:var(--gold);color:#000;box-shadow:0 0 20px var(--gold)}
    .cosmetic-icon{width:48px;height:48px;background:var(--goon);color:#000;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:1.3rem;box-shadow:0 0 18px var(--goon)}
    #ranked-gps{font-size:1.25rem;margin-bottom:14px;color:var(--gold);text-align:center;text-shadow:0 0 10px var(--gold)}
    #bot-battle{margin:12px auto 0;display:block;padding:12px 28px;background:var(--gold);color:#000;border:none;border-radius:14px;cursor:pointer;font-size:1.05rem;box-shadow:0 0 18px var(--gold)}
    #bot-battle:hover{transform:scale(1.05)}
    #bot-status{color:#ccc;font-size:.95rem;margin-top:10px;text-align:center}
    #ranked-cosmetics h4{font-size:1.2rem;margin:16px 0 10px;color:var(--gold);text-align:center}

    #splat-overlay{position:fixed;inset:0;pointer-events:none;z-index:999;opacity:0}
    .splat{position:absolute;width:100px;height:100px;background:#fff;border-radius:50%;filter:blur(20px);opacity:.8;animation:splatAnim 1.5s ease-out forwards}
    @keyframes splatAnim{0%{transform:scale(0);opacity:0}30%{transform:scale(1)}100%{transform:scale(5);opacity:0}}

    #loader{
      position:fixed;inset:0;background:var(--bg);
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      transition:opacity 1s ease;z-index:100;cursor:pointer
    }
    #logo{
      font-size:4.5rem;font-weight:900;text-transform:uppercase;color:var(--accent);
      letter-spacing:7px;background:linear-gradient(45deg,#fff,#bbb);
      background-clip:text;-webkit-background-clip:text;color:transparent;
      animation:glow 2.5s ease-in-out infinite alternate
    }
    @keyframes glow{from{text-shadow:0 0 18px var(--accent)}to{text-shadow:0 0 55px var(--accent),0 0 110px var(--accent)}}
    .last-updated{font-size:.85rem;color:var(--muted);text-align:center;margin:22px 0 16px;opacity:.85}
    footer{margin-top:16px;text-align:center;font-size:.8rem;color:var(--muted)}
    footer a{color:var(--muted);text-decoration:none;transition:.2s}
    footer a:hover{color:#ddd;text-decoration:underline}
    .credit{font-size:.75rem;color:#777;margin-top:10px;opacity:.65;font-style:italic}
    .hidden{display:none !important}
  </style>
</head>
<body>
<div class="stars" id="stars"></div>
<div id="loader" tabindex="0" role="button" aria-label="Enter">
  <div id="logo">GOONING</div>
  <div style="margin-top:20px;color:#999;font-size:1.2rem;">Click or press Enter</div>
</div>
<div id="app" class="hidden">
  <h1>Gooning Hub</h1>
  <div class="tabs">
    <div class="tab active" data-tab="leaderboard">Leaderboard</div>
    <div class="tab" data-tab="games">Mini‑Games</div>
  </div>

  <!-- LEADERBOARD PANEL -->
  <div id="leaderboard" class="panel active">
    <div id="loading" style="text-align:center;color:#bbb;margin:24px 0;font-size:1rem;">
      Loading leaderboard...
    </div>
    <div class="table-container">
      <table id="board" class="hidden">
        <thead><tr><th style="width:110px">Rank</th><th>Player</th></tr></thead>
        <tbody id="rows"></tbody>
      </table>
    </div>
    <div class="last-updated" id="updated"></div>
  </div>

  <!-- MINI-GAMES PANEL: GOON CLICKER -->
  <div id="games" class="panel">
    <div id="goon-game">
      <div id="goon-top">
        <div id="goon-left">
          <div id="next-prestige-bar">
            Next Goonstiege: <span id="next-threshold">3,000</span>
            <div id="prestige-progress"><div id="prestige-fill"></div></div>
          </div>
          <div id="goon-big">
            <svg viewBox="0 0 200 320" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <linearGradient id="skinGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" stop-color="#fdb"/>
                  <stop offset="100%" stop-color="#fea"/>
                </linearGradient>
                <linearGradient id="hairGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" stop-color="#321"/>
                  <stop offset="100%" stop-color="#210"/>
                </linearGradient>
                <linearGradient id="underwearGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" stop-color="#fff"/>
                  <stop offset="100%" stop-color="#ddd"/>
                </linearGradient>
                <pattern id="absPattern" patternUnits="userSpaceOnUse" width="40" height="40">
                  <path d="M0 20 Q10 15 20 20 T40 20" fill="none" stroke="#555" stroke-width="3"/>
                  <path d="M0 30 Q10 25 20 30 T40 30" fill="none" stroke="#555" stroke-width="3"/>
                </pattern>
              </defs>
              <path d="M65 35 Q80 15 100 10 Q120 15 135 35 Q140 55 135 65 Q100 75 65 65 Q60 55 65 35" fill="url(#hairGrad)" stroke="#210" stroke-width="2"/>
              <ellipse class="head" cx="100" cy="55" rx="38" ry="42" fill="url(#skinGrad)" stroke="#cca" stroke-width="2"/>
              <path d="M70 65 Q100 85 130 65" fill="none" stroke="#cca" stroke-width="3"/>
              <ellipse cx="82" cy="50" rx="12" ry="8" fill="#fff"/>
              <ellipse cx="118" cy="50" rx="12" ry="8" fill="#fff"/>
              <circle cx="85" cy="52" r="5" fill="#08d"/>
              <circle cx="121" cy="52" r="5" fill="#08d"/>
              <path d="M100 55 Q95 60 100 65" fill="none" stroke="#cca" stroke-width="2"/>
              <path d="M85 72 Q100 78 115 72" fill="none" stroke="#f68" stroke-width="4"/>
              <path d="M80 90 Q100 95 120 90 L125 110 Q100 120 75 110 Z" fill="url(#skinGrad)" stroke="#cca" stroke-width="2"/>
              <path d="M65 110 Q50 140 65 200 Q75 230 100 230 Q125 230 135 200 Q150 140 135 110 Z" fill="url(#skinGrad)" stroke="#cca" stroke-width="2"/>
              <ellipse cx="85" cy="130" rx="25" ry="18" fill="#fdb"/>
              <ellipse cx="115" cy="130" rx="25" ry="18" fill="#fdb"/>
              <circle cx="85" cy="135" r="5" fill="#c99"/>
              <circle cx="115" cy="135" r="5" fill="#c99"/>
              <rect x="75" y="145" width="50" height="70" fill="url(#absPattern)" opacity=".8"/>
              <path id="underwear-path" d="M70 200 Q100 210 130 200 Q135 220 130 230 L70 230 Q65 220 70 200 Z" fill="url(#underwearGrad)" stroke="#ccc" stroke-width="2"/>
              <ellipse cx="100" cy="215" rx="20" ry="14" fill="#eee" opacity=".9"/>
              <g class="arm">
                <path d="M130 120 Q155 115 170 125 Q180 135 175 145 Q165 140 155 135 L140 130 Z" fill="url(#skinGrad)" stroke="#cca" stroke-width="2"/>
                <circle cx="178" cy="138" r="20" fill="url(#skinGrad)" stroke="#cca" stroke-width="2"/>
                <path d="M172 145 Q178 155 184 145" fill="none" stroke="#cca" stroke-width="10"/>
              </g>
              <ellipse cx="82" cy="250" rx="20" ry="45" fill="url(#skinGrad)" stroke="#cca" stroke-width="2"/>
              <ellipse cx="118" cy="250" rx="20" ry="45" fill="url(#skinGrad)" stroke="#cca" stroke-width="2"/>
              <rect x="70" y="285" width="24" height="15" rx="6" fill="#fdb"/>
              <rect x="106" y="285" width="24" height="15" rx="6" fill="#fdb"/>
            </svg>
          </div>
          <div id="goon-stats">Goons: <span id="goons">0</span> | GPS: <span id="gps">0.0</span> <span id="goon-multiplier">x1.0</span></div>
          <button id="goon-prestige">Goonstiege (0)</button>
        </div>
        <div id="goon-upgrades-wrapper">
          <div id="goon-upgrades"></div>
        </div>
      </div>
      <div id="goon-bottom">
        <div id="cosmetic-shop">
          <h3>Cosmetic Shop</h3>
          <div id="cosmetics-list"></div>
        </div>
        <div id="ranked-mode">
          <h3>Ranked Mode</h3>
          <div id="ranked-gps">Your Ranked GPS: <span id="ranked-gps-val">0.0</span></div>
          <button id="bot-battle">Battle Bot (Coming Soon)</button>
          <div id="bot-status"></div>
          <div id="ranked-cosmetics">
            <h4>Ranked Cosmetics</h4>
            <div id="ranked-cosmetics-list"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    Auto‑refreshed • <a href="leaderboard.json" target="_blank">view raw JSON</a>
    <div class="credit">Site made by Xen</div>
  </footer>
</div>
<div id="splat-overlay"></div>

<script>
  const $ = id => document.getElementById(id);

  /* STARFALL */
  function createStar(){
    const s=document.createElement('div');s.className='star';
    const sz=Math.random()*3+1;
    s.style.width=s.style.height=`${sz}px`;
    s.style.left=`${Math.random()*100}vw`;
    s.style.animationDuration=`${Math.random()*8+5}s`;
    s.style.animationDelay=`${Math.random()*5}s`;
    s.style.opacity=Math.random()*0.6+0.3;
    $('#stars').appendChild(s);
    setTimeout(()=>s.remove(),15000);
  }
  setInterval(createStar,300);
  for(let i=0;i<50;i++)setTimeout(createStar,i*80);

  /* TABS */
  document.querySelectorAll('.tab').forEach(tab=>{
    tab.addEventListener('click',()=>{
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
      document.querySelectorAll('.panel').forEach(p=>p.classList.remove('active'));
      tab.classList.add('active');
      $(tab.dataset.tab).classList.add('active');
    });
  });

  /* DISCORD AVATAR */
  function getDiscordAvatar(uid,hash,size=80){
    if(!uid||!hash)return'https://cdn.discordapp.com/embed/avatars/0.png';
    const ext=hash.startsWith('a_')?'gif':'webp';
    return`https://cdn.discordapp.com/avatars/${uid}/${hash}.${ext}?size=${size}`;
  }

  /* LOADER */
  function enterLeaderboard(){
    const l=$('loader');l.style.opacity='0';
    setTimeout(()=>{l.classList.add('hidden');$('app').classList.remove('hidden');fetchLeaderboard();setInterval(fetchLeaderboard,90000);},1000);
  }
  $('loader').addEventListener('click',enterLeaderboard);
  $('loader').addEventListener('keydown',e=>{if(e.key==='Enter'||e.key===' '){e.preventDefault();enterLeaderboard();}});
  setTimeout(()=>$('loader').focus(),100);

  /* LEADERBOARD FETCH */
  async function fetchLeaderboard(){
    const loading=$('loading'),board=$('board'),rows=$('rows'),updated=$('updated');
    try{
      const res=await fetch('leaderboard.json?'+Date.now());
      if(!res.ok)throw'';
      const data=await res.json();
      let list=Array.isArray(data)?data:(data.leaderboard||[]);
      const time=data.updated||new Date().toLocaleTimeString([],[{hour:'2-digit',minute:'2-digit'}]);
      const padded=[];
      for(let i=0;i<100;i++)padded.push(list[i]||{rank:i+1});
      rows.innerHTML=padded.map((p,idx)=>{
        const has=p.name||p.discord;
        const av=getDiscordAvatar(p.discordId,p.avatar);
        const rank=p.rank||idx+1;
        return`<tr>
          <td class="rank">${rank}</td>
          <td class="name">
            ${has?`
            <div class="avatar"><img src="${av}" onerror="this.src='https://cdn.discordapp.com/embed/avatars/0.png'" alt="${e(p.name||'User')}"></div>
            <div>
              <div style="font-weight:600;font-size:1.04rem;">${e(p.name||'Unknown')}</div>
              ${p.discord?`<div class="discord-tag"><i class="fab fa-discord"></i>${e(p.discord)}</div>`:''}
            </div>`:`<div class="empty-slot">— Empty Slot —</div>`}
          </td>
        </tr>`;
      }).join('');
      updated.textContent=`Last updated: ${time}`;
      loading.classList.add('hidden');board.classList.remove('hidden');
    }catch{
      loading.textContent='Failed to load leaderboard.';loading.style.color='#f88';
    }
  }

  /* GOON CLICKER */
  const SAVE_KEYS = ['goonClickerSave_v6','goonClickerSave_v5','goonClickerSave_v4','goonClickerSave_v3','goonClickerSave_v2','goonClickerSave'];
  const SAVE_KEY = 'goonClickerSave_v7';
  let goons = 0, gps = 0, prestige = 0, rankedGPS = 0, threshold = 3000;
  let clickTimeout = null;
  const baseCosts = [25,110,1010,8010,50010,200010];
  const incs = [0.1,1,10,50,200,1000];
  const cosmetics = [
    {id:'stained-pants',name:'Stained Underwear',cost:5000,icon:'tint',owned:false},
    {id:'goon-glasses',name:'Goon Glasses',cost:10000,icon:'glasses',owned:false},
    {id:'goon-hat',name:'Goon Hat',cost:15000,icon:'hat-cowboy',owned:false},
    {id:'goon-aura',name:'Goon Aura',cost:30000,icon:'spa',owned:false}
  ];
  const rankedCosmetics = [
    {id:'bronze',name:'Bronze Badge',threshold:100,icon:'medal',unlocked:false},
    {id:'silver',name:'Silver Badge',threshold:500,icon:'medal',unlocked:false},
    {id:'gold',name:'Gold Trophy',threshold:2000,icon:'trophy',unlocked:false},
    {id:'diamond',name:'Diamond Gem',threshold:10000,icon:'gem',unlocked:false}
  ];
  const upgrades = [
    {id:'auto',name:'Auto-Gooner',cost:baseCosts[0],inc:incs[0],owned:0,icon:'robot'},
    {id:'factory',name:'Goon Factory',cost:baseCosts[1],inc:incs[1],owned:0,icon:'industry'},
    {id:'portal',name:'Goon Portal',cost:baseCosts[2],inc:incs[2],owned:0,icon:'portal-enter'},
    {id:'edge',name:'Edging Master',cost:baseCosts[3],inc:incs[3],owned:0,icon:'clock'},
    {id:'harem',name:'Goon Harem',cost:baseCosts[4],inc:incs[4],owned:0,icon:'users'},
    {id:'hypno',name:'Hypno Goon',cost:baseCosts[5],inc:incs[5],owned:0,icon:'eye'}
  ];
  const big=$('goon-big'),goonDisp=$('goons'),gpsDisp=$('gps'),multiDisp=$('goon-multiplier'),upDiv=$('goon-upgrades'),prestigeBtn=$('goon-prestige');
  const nextThresh=$('next-threshold'),progFill=$('prestige-fill'),overlay=$('splat-overlay');
  const cosmeticsList=$('cosmetics-list'),rankedList=$('ranked-cosmetics-list'),rankedVal=$('ranked-gps-val'),botStatus=$('bot-status');

  function getMult(){return 1 + prestige * 0.5;}

  function calcThreshold(){return Math.floor(3000 * Math.pow(1.8, prestige));}

  function saveGame(){
    const saveData = {
      goons, gps, prestige, threshold, rankedGPS,
      upgrades: upgrades.map(u=>({id:u.id,owned:u.owned,cost:u.cost})),
      cosmetics: cosmetics.map(c=>({id:c.id,owned:c.owned})),
      rankedCosmetics: rankedCosmetics.map(c=>({id:c.id,unlocked:c.unlocked})),
      version:7
    };
    localStorage.setItem(SAVE_KEY, JSON.stringify(saveData));
  }

  function loadGame(){
    let loaded = false;
    for(const key of SAVE_KEYS){
      const saved = localStorage.getItem(key);
      if(saved){
        try{
          const d = JSON.parse(saved);
          goons = Number(d.goons) || 0;
          gps = Number(d.gps) || 0;
          prestige = Number(d.prestige) || 0;
          rankedGPS = Number(d.rankedGPS) || 0;
          threshold = Number(d.threshold) || calcThreshold();
          if(d.upgrades){
            d.upgrades.forEach(u=>{
              const x = upgrades.find(v=>v.id===u.id);
              if(x){
                x.owned = Number(u.owned) || 0;
                x.cost = Number(u.cost) || baseCosts[upgrades.indexOf(x)];
              }
            });
          }
          gps = upgrades.reduce((a,u)=>a + u.inc * u.owned * getMult(),0);
          const cosArr = d.cosmetics || d.ownedCosmetics || [];
          cosArr.forEach(item => {
            const id = item.id || item;
            const c = cosmetics.find(v=>v.id===id);
            if(c) c.owned = true;
          });
          const rcArr = d.rankedCosmetics || d.unlockedRanked || [];
          rcArr.forEach(item => {
            const id = item.id || item;
            const c = rankedCosmetics.find(v=>v.id===id);
            if(c) c.unlocked = true;
          });
          loaded = true;
          break;
        }catch(e){console.error('Bad save',key,e);}
      }
    }
    if(!loaded){
      threshold = calcThreshold();
    }
  }

  function resetCosts(){upgrades.forEach((u,i)=>u.cost=baseCosts[i]);}

  function updateGoon(){
    goonDisp.textContent = Math.floor(goons).toLocaleString('en-US');
    gpsDisp.textContent = gps.toFixed(1);
    multiDisp.textContent = `x${getMult().toFixed(1)}`;
    prestigeBtn.textContent = `Goonstiege (${prestige})`;
    prestigeBtn.classList.toggle('disabled', goons < threshold);
    nextThresh.textContent = threshold.toLocaleString('en-US');
    progFill.style.width = `${Math.min(100, (goons / threshold) * 100)}%`;

    upDiv.innerHTML = '';
    upgrades.forEach(u => {
      const div = document.createElement('div'); div.className = 'goon-upgrade'; div.id = u.id;
      div.classList.toggle('disabled', goons < u.cost);
      div.innerHTML = `
        <div class="goon-upgrade-icon"><i class="fas fa-${u.icon}"></i></div>
        <div style="flex:1">
          <div style="font-weight:600">${u.name}</div>
          <div style="font-size:.92rem;color:#ccc">Owned: <span class="owned">${u.owned}</span> | Cost: <span class="cost">${u.cost.toLocaleString('en-US')}</span> | +<span class="inc">${(u.inc*getMult()).toFixed(1)}</span>/s</div>
        </div>
      `;
      div.addEventListener('click', () => {
        if(goons >= u.cost && !div.classList.contains('disabled')){
          div.style.transition = 'transform .12s';
          div.style.transform = 'scale(0.94)';
          clickTimeout = setTimeout(()=>{div.style.transform='';},120);
          goons -= u.cost;
          u.owned++;
          u.cost = Math.ceil(u.cost * 1.15);
          gps += u.inc * getMult();
          updateGoon();
          saveGame();
        }
      });
      upDiv.appendChild(div);
    });

    cosmeticsList.innerHTML = '';
    cosmetics.forEach(c => {
      const div = document.createElement('div'); div.className = 'cosmetic-item';
      div.classList.toggle('locked', !c.owned && goons < c.cost);
      div.classList.toggle('unlocked', c.owned);
      div.innerHTML = `
        <div class="cosmetic-icon"><i class="fas fa-${c.icon}"></i></div>
        <div style="font-weight:600">${c.name}</div>
        <div style="font-size:.88rem;color:#ccc">Cost: ${c.cost.toLocaleString('en-US')}</div>
      `;
      div.addEventListener('click', () => {
        if(!c.owned && goons >= c.cost){
          div.style.transition = 'transform .12s';
          div.style.transform = 'scale(0.94)';
          clickTimeout = setTimeout(()=>{div.style.transform='';},120);
          goons -= c.cost;
          c.owned = true;
          applyCosmetics();
          updateGoon();
          saveGame();
        }
      });
      cosmeticsList.appendChild(div);
    });

    rankedVal.textContent = rankedGPS.toFixed(1);
    rankedList.innerHTML = '';
    rankedCosmetics.forEach(c => {
      c.unlocked = rankedGPS >= c.threshold;
      const div = document.createElement('div'); div.className = 'ranked-cosmetic';
      div.classList.toggle('unlocked', c.unlocked);
      div.innerHTML = `
        <div class="cosmetic-icon"><i class="fas fa-${c.icon}"></i></div>
        <div style="font-weight:600">${c.name}</div>
        <div style="font-size:.88rem;color:#ccc">${c.unlocked ? 'Unlocked' : `Need ${c.threshold} GPS`}</div>
      `;
      rankedList.appendChild(div);
    });

    applyCosmetics();
  }

  function applyCosmetics(){
    const grad = document.getElementById('underwearGrad');
    if(grad && cosmetics.find(c=>c.id==='stained-pants')?.owned){
      grad.innerHTML = '<stop offset="0%" stop-color="#fffa"/><stop offset="100%" stop-color="#ffee"/>';
    }
  }

  function bustAnimation(){
    overlay.innerHTML = '';
    overlay.style.opacity = 1;
    for(let i=0;i<70;i++){
      const s = document.createElement('div');
      s.className='splat';
      s.style.left=`${Math.random()*100}%`;
      s.style.top=`${Math.random()*100}%`;
      s.style.width=s.style.height=`${Math.random()*240+100}px`;
      s.style.background='#fff';
      s.style.filter='blur(40px)';
      s.style.animationDelay=`${Math.random()*0.5}s`;
      overlay.appendChild(s);
    }
    setTimeout(()=>{overlay.style.opacity=0; overlay.innerHTML='';},3000);
  }

  big.addEventListener('click',()=>{ 
    goons += 1 * getMult(); 
    updateGoon();
    saveGame();
    big.style.transition = 'transform .12s';
    big.style.transform = 'scale(0.92)';
    clickTimeout = setTimeout(()=>{big.style.transform='';},120);
  });

  prestigeBtn.addEventListener('click', () => {
    if(goons >= threshold){
      bustAnimation();
      prestige++;
      goons = 0;
      gps = 0;
      threshold = calcThreshold();
      upgrades.forEach(u => u.owned = 0);
      resetCosts();
      updateGoon();
      saveGame();
    }
  });

  $('#bot-battle').addEventListener('click', () => {
    botStatus.textContent = 'Battling bot...';
    setTimeout(() => {
      const win = Math.random() > 0.3;
      rankedGPS += win ? 20 + prestige*5 : -7;
      rankedGPS = Math.max(0, rankedGPS);
      botStatus.textContent = win ? 'Win! +Ranked GPS' : 'Loss! -Ranked GPS';
      updateGoon();
      saveGame();
    }, 2500);
  });

  setInterval(() => {
    if(gps > 0){
      goons += gps / 3;
      updateGoon();
    }
  }, 333);

  document.addEventListener('selectstart', e => e.preventDefault());
  document.addEventListener('mousedown', e => e.preventDefault());

  loadGame();
  updateGoon();
  setInterval(saveGame, 6000);

  function e(t){const d=document.createElement('div');d.textContent=t;return d.innerHTML;}
</script>
</body>
</html>
